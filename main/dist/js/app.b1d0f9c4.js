(function(){var t={5281:function(t,e,n){var r={"./ass.js":8415,"./json.js":6129,"./lrc.js":5061,"./sbv.js":3079,"./smi.js":3088,"./srt.js":4255,"./ssa.js":8726,"./sub.js":3944,"./vtt.js":2661};function i(t){var e=o(t);return n(e)}function o(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=5281},8069:function(t,e,n){"use strict";var r=n(9242),i=n(3396),o=n(7139);const s=t=>((0,i.dD)("data-v-565c4c18"),t=t(),(0,i.Cn)(),t),a={key:0,style:{"z-index":"1",position:"fixed",top:"0",left:"0","background-color":"#fafafa","border-top":"1px solid #ddd",padding:"8px 16px"}},u=s((()=>(0,i._)("label",null,"재생 시간",-1))),l=s((()=>(0,i._)("br",null,null,-1))),c=s((()=>(0,i._)("hr",null,null,-1))),d=s((()=>(0,i._)("br",null,null,-1))),p=s((()=>(0,i._)("br",null,null,-1))),f=s((()=>(0,i._)("br",null,null,-1))),h=s((()=>(0,i._)("br",null,null,-1))),m=s((()=>(0,i._)("br",null,null,-1))),y=s((()=>(0,i._)("br",null,null,-1))),v={key:1,style:{"z-index":"2",position:"fixed",bottom:"10%",left:"0",right:"0"}},g={style:{position:"absolute",bottom:"0",left:"50%","font-size":"16px",transform:"translateX(-50%)"},class:"ccarea"},b=["innerHTML"];function w(t,e,n,r,s,w){const T=(0,i.up)("YoutubeVue3");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(T,{style:{"z-index":"1",position:"fixed",top:"0",bottom:"0",left:"0",right:"0"},ref:"youtube",controls:1,videoid:s.video.video_id,loop:s.video.loop,width:s.window.innerWidth,height:s.window.innerHeight,onEnded:w.onEnded,onPaused:w.onPaused,onPlayed:w.onPlayed,onReady:w.onReady},null,8,["videoid","loop","width","height","onEnded","onPaused","onPlayed","onReady"]),s.debug?((0,i.wg)(),(0,i.iD)("div",a,[(0,i._)("div",null," 디버그 모드 : "+(0,o.zw)(s.debug),1),(0,i._)("div",null,[u,(0,i._)("div",null," ("+(0,o.zw)(w.convertMillisecondsToVttTime(1e3*s.currentTime))+") ",1)]),l,c,(0,i._)("div",null,[(0,i.Uk)(" 비디오 상태 : "+(0,o.zw)(s.video),1),d,(0,i.Uk)(" 갱신 주기 : "+(0,o.zw)(s.timeCheck),1),p,(0,i.Uk)(" 타이머 아이디 : "+(0,o.zw)(s.timer),1),f,(0,i.Uk)(" 타임 싱크 : "+(0,o.zw)(s.timeSync),1),h,(0,i.Uk)(" 자막 경로 : "+(0,o.zw)(s.ccPath),1),m,(0,i.Uk)(" 자막 인코딩 : "+(0,o.zw)(s.ccEncoding),1),y]),(0,i._)("div",null," 실시간 자막 : "+(0,o.zw)(s.currentCC),1),(0,i._)("button",{onClick:e[0]||(e[0]=(...t)=>w.applyConfig&&w.applyConfig(...t))},"적용"),(0,i._)("button",{onClick:e[1]||(e[1]=(...t)=>w.playCurrentVideo&&w.playCurrentVideo(...t))},"재생"),(0,i._)("button",{onClick:e[2]||(e[2]=(...t)=>w.stopCurrentVideo&&w.stopCurrentVideo(...t))},"중지"),(0,i._)("button",{onClick:e[3]||(e[3]=(...t)=>w.pauseCurrentVideo&&w.pauseCurrentVideo(...t))},"정지")])):(0,i.kq)("",!0),s.playingFlag?((0,i.wg)(),(0,i.iD)("div",v,[(0,i._)("div",g,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.currentCC,((t,e)=>((0,i.wg)(),(0,i.iD)("div",{key:e},[(0,i._)("p",{style:{background:"rgb(0 0 0 / 69%)",color:"#fafafa"},innerHTML:w.replaceNewLineWithBreak(t)},null,8,b)])))),128))])])):(0,i.kq)("",!0)],64)}n(7658);var T=n(9900),_=n(3547),C=n(4471),k=n.n(C),x={name:"App",data(){const t=this.getQueryParams();return{window:window,debug:"1"==t["debug"],playingFlag:!1,video:{video_id:"",loop:1},currentTime:0,timeCheck:1e3/30,timer:void 0,vtt:[],videoIframe:void 0,currentCC:[],timeSync:Number(t["cc_sync"])??0,ccEncoding:t["cc_encode"]??"utf-8",ccPath:t["cc_uri"]??"https://raw.githubusercontent.com/rkdmf0000/cc-collection/main/back%20number%20-%20%E6%B0%B4%E5%B9%B3%E7%B7%9A.srt"}},async mounted(){this.video.video_id=location.hash.substring(1,99),this.video.loop=1,this.window.addEventListener("message",(function(t){t.origin})),this.$refs.youtube.player.on("ready",(async()=>{this.videoIframe=await this.$refs.youtube.player.getIframe()})),this.getRequest(this.ccPath).then((t=>{const e=k().convert(t,{format:"vtt",fps:25}),n=this.parseSmiFile(e);this.vtt=n})).catch((t=>{console.error(t)}))},components:{YoutubeVue3:T.YoutubeVue3},methods:{getCaptionsInRange(t,e){return t.filter((t=>t.start<=e&&t.end>=e))},replaceNewLineWithBreak(t){return t.replace(/\n/g,"<br>")},getRequest(t){return new Promise(((e,n)=>{const r=new XMLHttpRequest;r.overrideMimeType(` text/plain; charset=${this.ccEncoding}`),r.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&(this.status>=200&&this.status<300?e(r.responseText):n(new Error(`Request failed with status code: ${r.status}`)))},r.open("GET",t,!0),r.send()}))},parseSmiFile(t){const e=new _.WebVTTParser,n=e.parse(t),r=n.cues.map((t=>({start:t.startTime+this.timeSync,end:t.endTime+this.timeSync,text:t.text})));return r},smiToVtt(t){const e=/<sync start=(\d+)><p[^>]*>(.*?)<\/p>/g;let n,r="WEBVTT\n\n";while(null!==(n=e.exec(t))){const t=this.convertMillisecondsToVttTime(n[1]),e=n[2].replace(/(<br>)+/gi,"\n"),i=this.convertMillisecondsToVttTime(parseInt(n[1],10)+100*e.length);r+=`${t} --\x3e ${i}\n${e}\n\n`}return r},convertMillisecondsToVttTime(t){const e=Math.floor(t/36e5),n=Math.floor(t/6e4)%60,r=Math.floor(t/1e3)%60,i=(t%1e3).toString().padStart(3,"0");return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}.${i}`},startTimer(){this.timer=setInterval((()=>{this.timerAction()}),this.timeCheck)},stopTimer(){clearTimeout(this.timer)},async timerAction(){const t=await this.$refs.youtube.player.getCurrentTime();if(this.currentTime=t,this.currentCC=[],0!=this.vtt.length){const t=this.getCaptionsInRange(this.vtt,this.currentTime);0!=t.length&&t.map((t=>{this.currentCC.push(t.text)}))}},getQueryParams(){const t={},e=new URLSearchParams(location.search);for(let[n,r]of e.entries())t[n]?Array.isArray(t[n])?t[n].push(r):t[n]=[t[n],r]:t[n]=r;return t},convertTimeToSeconds(t){const e=t.split(":").map(parseFloat),n=3600*e[0],r=60*e[1],i=e[2]+e[3]/1e3,o=n+r+i;return parseFloat(o.toFixed(5))},applyConfig(){this.video={loop:0,video_id:"iqEr3P78fz8"}},playCurrentVideo(){this.$refs.youtube.player.playVideo()},stopCurrentVideo(){this.$refs.youtube.player.stopVideo()},pauseCurrentVideo(){this.$refs.youtube.player.pauseVideo()},onReady(){},onPlayed(){this.startTimer(),this.playingFlag=!0},onEnded(){this.stopTimer(),this.playingFlag=!1},onPaused(){this.stopTimer(),this.playingFlag=!1}}},S=n(89);const V=(0,S.Z)(x,[["render",w],["__scopeId","data-v-565c4c18"]]);var P=V,j=(0,i.aZ)({__name:"App",setup(t){return(t,e)=>((0,i.wg)(),(0,i.j4)(P))}});const E=j;var O=E;(0,r.ri)(O).mount("#app")}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.m=t,function(){var t=[];n.O=function(e,r,i,o){if(!r){var s=1/0;for(c=0;c<t.length;c++){r=t[c][0],i=t[c][1],o=t[c][2];for(var a=!0,u=0;u<r.length;u++)(!1&o||s>=o)&&Object.keys(n.O).every((function(t){return n.O[t](r[u])}))?r.splice(u--,1):(a=!1,o<s&&(s=o));if(a){t.splice(c--,1);var l=i();void 0!==l&&(e=l)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[r,i,o]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,r){var i,o,s=r[0],a=r[1],u=r[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(u)var c=u(n)}for(e&&e(r);l<s.length;l++)o=s[l],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(c)},r=self["webpackChunkmain"]=self["webpackChunkmain"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(8069)}));r=n.O(r)})();
//# sourceMappingURL=app.b1d0f9c4.js.map