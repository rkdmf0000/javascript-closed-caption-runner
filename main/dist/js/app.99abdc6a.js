(function(){var t={5281:function(t,e,n){var o={"./ass.js":8415,"./json.js":6129,"./lrc.js":5061,"./sbv.js":3079,"./smi.js":3088,"./srt.js":4255,"./ssa.js":8726,"./sub.js":3944,"./vtt.js":2661};function r(t){var e=i(t);return n(e)}function i(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}r.keys=function(){return Object.keys(o)},r.resolve=i,t.exports=r,r.id=5281},306:function(t,e,n){"use strict";var o=n(9242),r=n(3396),i=n(7139);const s={key:0,style:{"background-color":"#fafafa","border-top":"1px solid #ddd",padding:"8px 16px"}},u=(0,r._)("label",null,"재생 시간",-1),a=(0,r._)("br",null,null,-1),l=(0,r._)("hr",null,null,-1),d=(0,r._)("br",null,null,-1),c=(0,r._)("br",null,null,-1),p=(0,r._)("br",null,null,-1);function f(t,e,n,o,f,h){const v=(0,r.up)("YoutubeVue3");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",null,[(0,r.Wm)(v,{ref:"youtube",controls:1,videoid:f.video.video_id,loop:f.video.loop,width:480,height:320,onEnded:h.onEnded,onPaused:h.onPaused,onPlayed:h.onPlayed},null,8,["videoid","loop","onEnded","onPaused","onPlayed"])]),(0,r._)("div",null," 디버그 모드 : "+(0,i.zw)(f.debug),1),f.debug?((0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",null,[u,(0,r._)("div",null,(0,i.zw)(f.currentTime),1)]),a,l,(0,r._)("div",null,[(0,r.Uk)(" 비디오 상태 : "+(0,i.zw)(f.video),1),d,(0,r.Uk)(" 갱신 주기 : "+(0,i.zw)(f.timeCheck),1),c,(0,r.Uk)(" 타이머 아이디 : "+(0,i.zw)(f.timer),1),p]),(0,r._)("div",null," 실시간 자막 : "+(0,i.zw)(f.currentCC),1),(0,r._)("button",{onClick:e[0]||(e[0]=(...t)=>h.applyConfig&&h.applyConfig(...t))},"적용"),(0,r._)("button",{onClick:e[1]||(e[1]=(...t)=>h.playCurrentVideo&&h.playCurrentVideo(...t))},"재생"),(0,r._)("button",{onClick:e[2]||(e[2]=(...t)=>h.stopCurrentVideo&&h.stopCurrentVideo(...t))},"중지"),(0,r._)("button",{onClick:e[3]||(e[3]=(...t)=>h.pauseCurrentVideo&&h.pauseCurrentVideo(...t))},"정지")])):(0,r.kq)("",!0)],64)}n(7658);var h=n(9900),v=n(3547),m=n(4471),b=n.n(m),g={name:"App",data(){return{debug:!0,video:{video_id:"",loop:1},currentTime:0,timeCheck:1e3/60,timer:void 0,vtt:[],currentCC:[]}},mounted(){this.video.video_id=location.hash.substring(1,99),this.video.loop=1,this.getRequest("https://raw.githubusercontent.com/rkdmf0000/javascript-closed-caption-runner/main/main/dist/test1.smi").then((t=>{const e=b().convert(t,{format:"vtt",fps:25}),n=this.parseSmiFile(e);this.vtt=n})).catch((t=>{console.error(t)}))},components:{YoutubeVue3:h.YoutubeVue3},methods:{getCaptionsInRange(t,e){return t.filter((t=>t.start<=e&&t.end>=e))},getRequest(t){return new Promise(((e,n)=>{const o=new XMLHttpRequest;o.overrideMimeType(" text/plain; charset=euc-kr"),o.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&(this.status>=200&&this.status<300?e(o.responseText):n(new Error(`Request failed with status code: ${o.status}`)))},o.open("GET",t,!0),o.send()}))},parseSmiFile(t){const e=new v.WebVTTParser,n=e.parse(t),o=n.cues.map((t=>({start:t.startTime,end:t.endTime,text:t.text})));return o},smiToVtt(t){const e=/<sync start=(\d+)><p[^>]*>(.*?)<\/p>/g;let n,o="WEBVTT\n\n";while(null!==(n=e.exec(t))){const t=this.convertMillisecondsToVttTime(n[1]),e=n[2].replace(/(<br>)+/gi,"\n"),r=this.convertMillisecondsToVttTime(parseInt(n[1],10)+100*e.length);o+=`${t} --\x3e ${r}\n${e}\n\n`}return o},convertMillisecondsToVttTime(t){const e=Math.floor(t/36e5),n=Math.floor(t/6e4)%60,o=Math.floor(t/1e3)%60,r=(t%1e3).toString().padStart(3,"0");return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}.${r}`},startTimer(){this.timer=setInterval((()=>{this.timerAction()}),this.timeCheck)},stopTimer(){clearTimeout(this.timer)},async timerAction(){const t=await this.$refs.youtube.player.getCurrentTime();if(this.currentTime=t,this.currentCC=[],0!=this.vtt.length){const t=this.getCaptionsInRange(this.vtt,this.currentTime);0!=t.length&&t.map((t=>{this.currentCC.push(t.text)}))}},convertTimeToSeconds(t){const e=t.split(":").map(parseFloat),n=3600*e[0],o=60*e[1],r=e[2]+e[3]/1e3,i=n+o+r;return parseFloat(i.toFixed(5))},applyConfig(){this.video={loop:0,video_id:"hlNWfslbSGA"}},playCurrentVideo(){this.$refs.youtube.player.playVideo()},stopCurrentVideo(){this.$refs.youtube.player.stopVideo()},pauseCurrentVideo(){this.$refs.youtube.player.pauseVideo()},onPlayed(){console.log("## OnPlayed"),this.startTimer()},onEnded(){console.log("## OnEnded"),this.stopTimer()},onPaused(){console.log("## OnPaused"),this.stopTimer()}}},y=n(89);const T=(0,y.Z)(g,[["render",f]]);var C=T,w=(0,r.aZ)({__name:"App",setup(t){return(t,e)=>((0,r.wg)(),(0,r.j4)(C))}});const _=w;var k=_;(0,o.ri)(k).mount("#app")}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,o,r,i){if(!o){var s=1/0;for(d=0;d<t.length;d++){o=t[d][0],r=t[d][1],i=t[d][2];for(var u=!0,a=0;a<o.length;a++)(!1&i||s>=i)&&Object.keys(n.O).every((function(t){return n.O[t](o[a])}))?o.splice(a--,1):(u=!1,i<s&&(s=i));if(u){t.splice(d--,1);var l=r();void 0!==l&&(e=l)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[o,r,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var r,i,s=o[0],u=o[1],a=o[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(r in u)n.o(u,r)&&(n.m[r]=u[r]);if(a)var d=a(n)}for(e&&e(o);l<s.length;l++)i=s[l],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(d)},o=self["webpackChunkmain"]=self["webpackChunkmain"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(306)}));o=n.O(o)})();
//# sourceMappingURL=app.99abdc6a.js.map